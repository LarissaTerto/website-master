<map>
    <div id="bigmap-container">
        <div id="map-parent-container" class="{ map-big: opts.big }">
            <div id="map-container"/>
            <div class="map-attribution">
                <a target="_blank" href="http://www.openstreetmap.org/">OSM</a>
                <a target="_blank" href="http://opendatacommons.org/licenses/odbl/">ODbL</a>
                <a target="_blank" href="http://www.mapquest.com/terms-of-use">MQ</a>
            </div>
            <div if="{ opts.big }"
                 class="map-update-time">
                dados atualizados em { yearinfo['last_update'] }
            </div>
        </div>
    </div>
    <div class="input-group search-address"
         if="{ opts.big }">
        <input id="search-address-input"
               class="input-medium search-query form-control"
               type="text"
               onkeypress="{ ifEnter(locateAddress) }"
               placeholder="Procure pelo bairro ou endereÃ§o">
        <span class="input-group-btn">
            <button onclick="{ locateAddress }"
                    class="btn btn-color-sec"
                    type="button">
                { t("Locate") }
            </button>
        </span>
    </div>


    <script type="es6">
    import map from './map'
    this.mixin('base')
    this.yearinfo = ''

    this.one('mount', () => {
        this.year = this.router.getParam('year')
        map.initMap('map-container')
        this.watchDepends('points', 'year', () => map.updateMap(this.points))
    })

    // Used to get last_update
    this.watchDepends('yearinfo', 'year', () => {
        if (this.yearinfo) this.update()
    })

    this.on('updated', () => {
        /*         map.setSizeBig(opts.big) */
        map.redraw()
    })

    this.locateAddress = () => {
        map.locateAddress(this['search-address-input'].value)
    }

    console.log('MAP BIG:', opts.big)

    </script>
</map>
