<perguntas>
    <div class="row">
        <div class="col-sm-8">
            <h2>Quer perguntar para o governo sobre essa despesa?</h2>
        </div>

        <div class="col-sm-4 new-perg-button">
            <button onclick={ openNewPerguntaForm }
                    class="btn btn-color-sec block-right">
                { t('Make a question') }
                <span class="right-arrow"/>
            </button>
        </div>
    </div>

    <modal>
        <new-pergunta-form/>
    </modal>

    <ul class="list-bare">
        <li class="top-bar"
            each="{ pedidos }">
            <div class="row">
                <div class="col-xs-1">
                    <img class="icon block-center" src="{ assets.aPer }">
                </div>
                <div class="col-xs-11 col-sm-7">
                    <div class="full-width {hide-extra: !visible}">
                        { description }
                    </div>
                </div>
                <div class="col-xs-12 col-sm-4">
                    <div class="row text-center">
                        <div class="col-xs-6">
                                { formatDate(date) }
                        </div>
                        <div class="col-xs-6">
                            <a onclick={ fRoute('pessoa ' + author) }>
                                { author }
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="text-right"
                if="{ !visible }">
                <a onclick="{ () => this.visible = true }">
                    { messages.length - 1 }
                    { messages.length-1 > 1 ? t("respostas") : t("resposta")}
                    <span class="down-arrow"></span>
                </a>
            </div>

            <div if="{ visible }">
                <h3>Respostas</h3>
                <ul class="list-bare">
                    <li each="{ messages }">
                        <div if="{ received }">
                            <b>{ t('Date') }:</b> { formatDate(received) }
                        </div>
                        <div if="{ responsavel }">
                            <b>{ t('Responsible') }:</b> { responsavel }
                        </div>
                        <div if="{ situacao }">
                            <b>{ t('State') }:</b> { situacao }
                        </div>
                        <p>{ text }</p>
                    </li>
                </ul>
                <a onclick="{ () => this.visible = false }">
                    { t('hide') }
                    <span class="up-arrow"></span>
                </a>
            </div>
        </li>
    </ul>


    <script type="es6">
    import {checkIsLogged} from '../../store/auth'
    import {formatDate} from '../../utils/helpers'
    this.formatDate = formatDate
    this.mixin('base')
    this.openNewPerguntaForm = (event) => {
        if (checkIsLogged(event)) {
            this.tags.modal.openModal(event)
        }
    }

    this.watchDepends('pedidos', 'code', () => {
        console.log('PEDIDOS:', this.pedidos)
        /*         if (this.sendingComment) {
           this.sendingComment = false
           this['comment-textarea'].value = ""
           } */
        this.update()
    })
    </script>
</perguntas>
